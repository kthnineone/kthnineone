# 서울 아파트 실거래가 예측 대회  
## 프로젝트 개요
패스트캠퍼스&업스테이지 AI Lab 1기 자체 대회  

서울의 아파트 실거래가를 예측하는 대회  

2007년 1월부터 2023년 9월까지의 데이터  
학습 데이터: 200701 - 202306  
평가 데이터: 202307 - 202309  

Puiblic과 Private은 각각 Random하게 5:5로 나뉜다.

추가 데이터로 지하철역, 버스정류장 정보 등이 존재  

평가 지표는 RMSE  

% 리더보드에 문제가 생겨서 리더보드와 validation 지표의 괴리가 생기는 문제가 있었다.  
이 때문에 리더보드를 기준으로 한 피드백이 올바르게 수행되지 못한 점이 아쉬운 프로젝트였다.  

팀 프로젝트: 5명   
역할: EDA, 피쳐 엔지니어링, 모델링  
진행기간: 2024.01.07 ~ 2024.01.25  
소속 : 패스트캠퍼스&업스테이지 AI Lab 1기 (AI Lab 2기)  


## 기술 스택
+ Scikit-Learn
+ Numpy
+ Pandas
+ XGBoost
+ LightGBM
+ optuna
+ matplotlib


## 프로젝트 진행 단계  
1. 데이터 확인 및 데이터 전처리    
2. 전처리된 데이터를 모델에 적용 후 확인 및 평가    
3. 1번과 2번 반복  
4. 최종 제출  


## 프로젝트 세부 과정  
### 1. 데이터 확인 및 전처리  
**연속형 변수:** 
'전용면적', '계약년월', '계약일', '층', '건축년도', 'k-전체동수', 'k-전체세대수', 'target' 등등 총 18개  

**범주형 변수:** 
'시군구', '번지', '본번', '부번', '아파트명', '도로명', 'k-단지분류(아파트,주상복합등등)' 등등 총 34개  

+ 구별 아파트 가격은 boxplot으로 볼 때 차이가 있다.  

+ 2022년을 기점으로 약간 경향이 달라지긴 하지만 전체적으로는 아파트 실거래가는 우상향한다.  

+ 관련이 없어 보이는 변수 'k-전화번호', 'k-팩스번호', 'k-관리방식', 'k-수정일자', '고용보험관리번호', '시군구', '계약년월' 삭제
 
+ 결측치가 100만개 이상인 변수들 : '해제사유발생일', '단지소개기존clob', 'k-135㎡초과', 'k-홈페이지', 'k-등록일자' 삭제

+ 평수에 따라서 소형, 중형, 대형으로 분류한 컬럼 추가
 
+ 평균면적 이상치 삭제 안함

+ 강남구라는 별도의 컬럼 추가 안함. 대신 구를 범주형 변수로 추가. 구별 동평 평균으로 지역 정보 삽입.   


### 3. 모델 선정  

Random Forest (RF), XGBoost (XGB), Light GBM (LGBM)  

XGB는 5-Fold와 optuna 사용시 시간이 너무 오래 소요되어 더 빠른 LGBM으로 선택후 고정  


### 4. 모델 적용 상세  
#### 4.1. 데이터 별 모델 적용  

아래의 모든 데이터에 LGBM을 적용했으며 optuna로 하이퍼파라미터 튜닝을 수행했다.  

1번 데이터 상세:
+ 면적, X좌표, Y좌표, 계약년, 계약월, 해당 년의 평균가격, 해당 월의 평균가격
+ 2020~2023년 데이터 사용. Train은 2020, 2021, 2022 데이터, Val은 2023년 데이터
+ 개별 가격 예측

2번 데이터 상세:
+ 전용면적, 층, 건설년도, 계약년도, 계약월, X, Y 좌표, 연도별 평균, 월별 평균, 구별 평균, 동별 평균, 도로별 평균 적용 예정
+ 2020~2023년 데이터 사용. Train은 2020, 2021, 2022 데이터, Val은 2023년 데이터
+ 개별 가격 예측

3번 데이터 상세:
+ 전용면적, 층, 건설년도, 계약년도, 계약월, X, Y 좌표, 연도별 평균, 월별 평균, 구별 평균, 동별 평균, 도로별 평균 적용 예정
+ 2020~2023년 데이터 사용. Train은 2020, 2021, 2022 데이터, Val은 2023년 데이터
+ 개별 가격 예측

4번 데이터 상세: 
+ 년, 월, 일, 소수점만 반영한 x, y 좌표, 면적을 이용.
+ groupby를 활용하여 면적의 카테고리를 소형, 중소형, 중형, 중대형, 대형, 초대형로 변경
+ 2020~2023년 데이터 사용. Train은 2020, 2021, 2022 데이터, Val은 2023년 데이터
+ 면적을 소형, 중소형, 중형, 중대형, 대형, 초대형으로 나눠서 mean으로 target인 price 생성 후 이를 예측

#### 5. 최종 제출   
 
+ 팀원의 모델을 제출  
+ 본인의 베스트 모델은 4번 데이터에 LGBM을 활용한 케이스  


## 프로젝트 결과  
총 9개팀 참여  
Public 등수: 3등  
Private 등수: 4등  

Public Score: 18200.0390
Final(Public + Private) Score: 16173.2293

## 프로젝트 회고  
+ 리더보드의 인덱스 에러 문제로 인해서 리더보드와 Validation RMSE의 괴리가 심했다. 이때 Validation을 믿고 진행했어야 정상적으로 돌아온 리더보드에서 좋은 성능을 보였을 듯 하다. 다른 대회에 또 참여할 때 Validation을 믿고 실험을 수행해야겠다.  
+ 실제 업무에서도 KPI의 설정은 정상적이더라도, 여러 이슈로 인해 성능 모니터링 대쉬보드 등이 잘못될 수 있다. 이를 유의해야겠다고 생각했다.  
+ Kaggle이나 다른 레퍼런스를 추가로 찾아봤으면 좋았을듯하다.  
+ 다른 팀원들과 토론하면서 인사이트를 얻을 수 있었고 각자 EDA나 수집한 데이터를 공유하여 시간을 아낄 수 있었다.
+ 강남구, 용산구, 서초구의 아파트 가격이 높아보였는데 이 세 구만 별도로 묶어서 예측하고, 다른 구들을 묶어서 예측하는 별도의 모델을 수행하지 않은 점이 아쉽다.
  
